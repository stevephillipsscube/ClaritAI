<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>61.0</apiVersion>
    <assignments>
        <name>Add_to_our_collection</name>
        <label>Add to our collection</label>
        <locationX>1106</locationX>
        <locationY>974</locationY>
        <assignmentItems>
            <assignToReference>Comments_Updated_Numbers</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Single_Comment</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>ReNumber_Rows</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Application_Contact</name>
        <label>Assign Application Contact</label>
        <locationX>50</locationX>
        <locationY>350</locationY>
        <assignmentItems>
            <assignToReference>Single_Application_Contact.MUSW__First_Name__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>App_Contact_First_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Single_Application_Contact.MUSW__Last_Name__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>App_Contact_Last_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Application_Contact_Collection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Single_Application_Contact</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_to_Our_Resulted_Application_Contact_List</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Comment</name>
        <label>Assign Comment</label>
        <locationX>666</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>Single_Comment.MUSW__BG_Description__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Comment_Description</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Single_Comment.MUSW__BG_Page__c</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Number</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Comment_Collection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Single_Comment</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Copy_1_of_Assign_Resulted_Comments_to_Assigned_List</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Comment_Number</name>
        <label>Assign Comment Number</label>
        <locationX>666</locationX>
        <locationY>350</locationY>
        <assignmentItems>
            <assignToReference>Number</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Comment_Collection</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Number</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Comment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Resulted_Comments_to_Assigned_List</name>
        <label>Assign Resulted Comments to Assigned List</label>
        <locationX>1018</locationX>
        <locationY>1166</locationY>
        <assignmentItems>
            <assignToReference>Comment_Collection_Assigned</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Comments_Updated_Numbers</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Default_Value_in_Subflow</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue> </stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Assign_Single_Comment</name>
        <label>Assign Single Comment</label>
        <locationX>1106</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>Comment_Collection</assignToReference>
            <operator>RemovePosition</operator>
            <value>
                <elementReference>Loop_Through_Removed_Values.MUSW__BG_Page__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Through_Removed_Values</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_to_Our_Resulted_Application_Contact_List</name>
        <label>Assign to Our Resulted Application Contact List</label>
        <locationX>270</locationX>
        <locationY>542</locationY>
        <assignmentItems>
            <assignToReference>Application_Contact_List_assigned</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Application_Contact_Collection</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Copy_1_of_Assign_Resulted_Comments_to_Assigned_List</name>
        <label>Copy 1 of Assign Resulted Comments to Assigned List</label>
        <locationX>666</locationX>
        <locationY>566</locationY>
        <assignmentItems>
            <assignToReference>Comment_Collection_Assigned</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Comment_Collection</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Default_Value_in_Subflow</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue> </stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Recount_Rows</name>
        <label>Recount Rows</label>
        <locationX>1106</locationX>
        <locationY>866</locationY>
        <assignmentItems>
            <assignToReference>Number</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Single_Comment</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ReNumber_Rows</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Single_Comment.MUSW__BG_Page__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Number</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_our_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Reset_Number_Value</name>
        <label>Reset Number Value</label>
        <locationX>1018</locationX>
        <locationY>650</locationY>
        <assignmentItems>
            <assignToReference>Number</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>ReNumber_Rows</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Are_we_removing_anything</name>
        <label>Are we removing anything?</label>
        <locationX>270</locationX>
        <locationY>242</locationY>
        <defaultConnector>
            <targetReference>Assign_to_Our_Resulted_Application_Contact_List</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Adding_Application_Contacts</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Application_Contact_List_assigned</leftValueReference>
                <operator>EqualTo</operator>
            </conditions>
            <connector>
                <targetReference>Assign_Application_Contact</targetReference>
            </connector>
            <label>Adding Application Contacts</label>
        </rules>
        <rules>
            <name>Removing_Application_Contacts</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Application_Contact_Collection</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_to_Our_Resulted_Application_Contact_List</targetReference>
            </connector>
            <label>Removing Application Contacts</label>
        </rules>
    </decisions>
    <decisions>
        <name>Are_we_removing_Comments</name>
        <label>Are we removing Comments</label>
        <locationX>974</locationX>
        <locationY>242</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Adding_Comments</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Removed_Comments</leftValueReference>
                <operator>IsEmpty</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Comment_Number</targetReference>
            </connector>
            <label>Adding Comments</label>
        </rules>
        <rules>
            <name>Removing_Comments</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Removed_Comments</leftValueReference>
                <operator>IsEmpty</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Through_Removed_Values</targetReference>
            </connector>
            <label>Removing Comments</label>
        </rules>
    </decisions>
    <decisions>
        <name>What_Object_Are_We_Getting_Passed</name>
        <label>What Object Are We Getting Passed?</label>
        <locationX>908</locationX>
        <locationY>134</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Application_Contact</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Object_Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>MUSW__Application_Contact__c</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Are_we_removing_anything</targetReference>
            </connector>
            <label>Application Contact</label>
        </rules>
        <rules>
            <name>Comment</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Object_Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>MUSW__Comment__c</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Are_we_removing_Comments</targetReference>
            </connector>
            <label>Comment</label>
        </rules>
    </decisions>
    <description>ZPM - testing salesforce error resolution.</description>
    <environments>Default</environments>
    <interviewLabel>Add Items {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Add Items From Flow</label>
    <loops>
        <name>Loop_Through_Removed_Values</name>
        <label>Loop Through Removed Values</label>
        <locationX>1018</locationX>
        <locationY>350</locationY>
        <collectionReference>Removed_Comments</collectionReference>
        <iterationOrder>Desc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_Single_Comment</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Reset_Number_Value</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>ReNumber_Rows</name>
        <label>ReNumber Rows</label>
        <locationX>1018</locationX>
        <locationY>758</locationY>
        <collectionReference>Comment_Collection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Recount_Rows</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Assign_Resulted_Comments_to_Assigned_List</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <start>
        <locationX>782</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>What_Object_Are_We_Getting_Passed</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>Action_Result_Message</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>App_Contact_First_Name</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>App_Contact_Last_Name</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Application_Contact_Collection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>MUSW__Application_Contact__c</objectType>
    </variables>
    <variables>
        <name>Application_Contact_List_assigned</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>MUSW__Application_Contact__c</objectType>
    </variables>
    <variables>
        <name>BlankValue</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Comment_Collection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>MUSW__Comment__c</objectType>
    </variables>
    <variables>
        <name>Comment_Collection_Assigned</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>MUSW__Comment__c</objectType>
    </variables>
    <variables>
        <name>Comment_Description</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Comments_To_Remove</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>MUSW__Comment__c</objectType>
    </variables>
    <variables>
        <name>Comments_Updated_Numbers</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>MUSW__Comment__c</objectType>
    </variables>
    <variables>
        <name>Default_Value_in_Subflow</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>Number</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>Object_Type</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>Removed_Comments</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>MUSW__Comment__c</objectType>
    </variables>
    <variables>
        <name>Single_Application_Contact</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>MUSW__Application_Contact__c</objectType>
    </variables>
    <variables>
        <name>Single_Comment</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>MUSW__Comment__c</objectType>
    </variables>
</Flow>
